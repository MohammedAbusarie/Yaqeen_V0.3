<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Modern attendance tracking tool - client-side processing, no server required" />
    <title>Yaqeen Attendance Tool</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <!-- Splash Screen -->
    <div id="splashScreen" class="splash-screen">
      <div class="splash-screen__content">
        <h1 class="splash-screen__title">Yaqeen V0.3</h1>
      </div>
    </div>

    <header class="appHeader">
      <div class="appHeader__title">
        <h1>Yaqeen Attendance Tool</h1>
        <p>Automated attendance & grades input â€¢ Time-saving â€¢ Privacy-first</p>
        <p style="margin-top: 4px; font-size: 13px; color: var(--text-muted);">Created by Mohammed Abusarie</p>
      </div>
      
      <nav class="appNav">
        <button id="navInputs" class="appNav__btn is-active" type="button">Inputs</button>
        <button id="navReport" class="appNav__btn" type="button">Report</button>
        <button id="navOcr" class="appNav__btn" type="button">OCR (Experimental)</button>
        <button id="navSheetMerger" class="appNav__btn" type="button">Sheet Merger</button>
        <button id="navAbout" class="appNav__btn" type="button">About</button>
      </nav>
    </header>

    <main class="appMain">
      <!-- Inputs View -->
      <section id="viewInputs" class="view view--active">
        <div class="card">
          <h2>Edit Workbook (Attendance / Grades)</h2>

          <!-- Wizard Steps Indicator -->
          <div class="wizard">
            <div class="wizard__steps">
              <div class="wizard__step" data-step="1">
                <div class="wizard__step-number">1</div>
                <div class="wizard__step-label">Load File</div>
              </div>
              <div class="wizard__step" data-step="2">
                <div class="wizard__step-number">2</div>
                <div class="wizard__step-label">Configure</div>
              </div>
              <div class="wizard__step" data-step="3">
                <div class="wizard__step-number">3</div>
                <div class="wizard__step-label">Input Data</div>
              </div>
              <div class="wizard__step" data-step="4">
                <div class="wizard__step-number">4</div>
                <div class="wizard__step-label">Generate Preview</div>
              </div>
            </div>

            <!-- Step 1: Load File -->
            <div class="wizard__panel" data-panel="1">
              <h3 class="wizard__panel-title">Step 1: Load File</h3>
              <div class="grid2">
                <div class="field">
                  <label for="editorSheetUrl">Google Sheet or SharePoint URL (optional)</label>
                  <input
                    id="editorSheetUrl"
                    type="url"
                    placeholder="https://docs.google.com/spreadsheets/d/.../edit or https://...sharepoint.com/..."
                    autocomplete="off"
                  />
                  <div class="hint">
                    We'll try to download as <code>.xlsx</code>. Supports Google Sheets and SharePoint. If blocked by CORS, export manually and upload below.
                  </div>
                </div>

                <div class="field">
                  <label for="editorXlsxFile">Upload attendance sheet (<code>.xlsx</code>, <code>.ods</code>, or <code>.csv</code>)</label>
                  <input id="editorXlsxFile" type="file" accept=".xlsx,.ods,.csv,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.oasis.opendocument.spreadsheet,text/csv" />
                  <div class="hint">Recommended. Works even when URL downloads are blocked. Supports Excel (.xlsx), OpenDocument (.ods), and CSV formats.</div>
                </div>
              </div>
            </div>

            <!-- Step 2: Configure -->
            <div class="wizard__panel" data-panel="2" hidden>
              <h3 class="wizard__panel-title">Step 2: Configure</h3>
              <div class="grid3">
                <div class="field">
                  <label for="editorScope">Mode</label>
                  <select id="editorScope">
                    <option value="single">Single-sheet mode</option>
                    <option value="multi">Multi-sheet mode</option>
                  </select>
                  <div class="hint">Choose whether the selected column applies to one sheet or all sheets.</div>
                </div>

                <div class="field">
                  <label for="editorSheet">Sheet (single mode)</label>
                  <select id="editorSheet" disabled>
                    <option value="">(Load file first)</option>
                  </select>
                  <div class="hint">Enabled only in single-sheet mode.</div>
                </div>

                <div class="field">
                  <label for="editorColumn">Target column header</label>
                  <select id="editorColumn" disabled>
                    <option value="">(Select mode + load file)</option>
                  </select>
                  <div class="hint">Headers are read from rows 2â€“5. Options are tagged as Lecture/Section when detected. The search below also includes row 1.</div>
                </div>
              </div>
              
              <div class="field" style="margin-top: 16px;">
                <label for="editorColumnSearch">Search column header</label>
                <input id="editorColumnSearch" type="text" autocomplete="off" placeholder="Type to search for a column headerâ€¦" disabled />
                <div class="hint">Search for a column header if you can't find it in the dropdown above.</div>
                <div id="editorColumnSearchResults" class="columnSearchResults" style="display: none;"></div>
              </div>
            </div>

            <!-- Step 3: Input Data -->
            <div class="wizard__panel" data-panel="3" hidden>
              <h3 class="wizard__panel-title">Step 3: Input Data</h3>
              <div class="grid2">
                <div class="field">
                  <label for="editorTask">Task type</label>
                  <select id="editorTask">
                    <option value="attendance">Attendance input (write 1)</option>
                    <option value="grade">Grade input (write grade)</option>
                  </select>
                </div>

                <div class="field">
                  <label>Input method</label>
                  <div style="display: flex; gap: 16px; margin-top: 8px;">
                    <label class="labelInline">
                      <input id="editorInputMethodFile" type="radio" name="editorInputMethod" value="file" checked style="margin-right: 6px;" />
                      Upload file
                    </label>
                    <label class="labelInline">
                      <input id="editorInputMethodTextarea" type="radio" name="editorInputMethod" value="textarea" style="margin-right: 6px;" />
                      Enter text
                    </label>
                  </div>
                </div>
              </div>

              <div class="field" id="editorInputFileContainer">
                <label for="editorInputTxt">Input file (<code>.txt</code>)</label>
                <input id="editorInputTxt" type="file" accept=".txt,text/plain" />
                <div class="hint">
                  Attendance: list of IDs (same delimiters as attendance).<br>
                  Grades: <code>id,grade</code> per line.
                </div>
              </div>

              <div class="field" id="editorInputTextareaContainer" style="display: none;">
                <label for="editorInputTextarea">Enter data</label>
                <textarea id="editorInputTextarea" rows="10" placeholder="Attendance: list of IDs (one per line, optional delimiter lines)&#10;Grades: id,grade per line"></textarea>
                <div class="hint">
                  Attendance: list of IDs (one per line). You can add delimiter/title lines between sections.<br>
                  Grades: <code>id,grade</code> per line. You can add delimiter/title lines between sections.
                </div>
              </div>
            </div>

            <!-- Step 4: Generate Preview -->
            <div class="wizard__panel" data-panel="4" hidden>
              <h3 class="wizard__panel-title">Step 4: Generate Preview</h3>
              <p style="color: var(--text-secondary); margin-bottom: 20px;">
                Review your configuration and generate the preview. You'll be taken to the Reports view to review the results.
              </p>
              <div class="wizard__summary">
                <div class="wizard__summary-item">
                  <strong>File:</strong> <span id="wizardSummaryFile">Not loaded</span>
                </div>
                <div class="wizard__summary-item">
                  <strong>Mode:</strong> <span id="wizardSummaryMode">-</span>
                </div>
                <div class="wizard__summary-item">
                  <strong>Sheet:</strong> <span id="wizardSummarySheet">-</span>
                </div>
                <div class="wizard__summary-item">
                  <strong>Column:</strong> <span id="wizardSummaryColumn">-</span>
                </div>
                <div class="wizard__summary-item">
                  <strong>Task:</strong> <span id="wizardSummaryTask">-</span>
                </div>
                <div class="wizard__summary-item">
                  <strong>Input File:</strong> <span id="wizardSummaryInput">-</span>
                </div>
              </div>
            </div>

            <!-- Wizard Navigation -->
            <div class="wizard__navigation">
              <button id="btnWizardPrev" class="btn btn--ghost" type="button" disabled>Previous</button>
              <button id="btnWizardNext" class="btn btn--primary" type="button">Next</button>
              <button id="btnWizardFinish" class="btn btn--primary" type="button" hidden disabled>
                <span class="btn__text">Generate Preview</span>
              </button>
            </div>

            <div id="editorStatus" class="status" style="margin-top: 20px;" aria-live="polite"></div>
          </div>
        </div>

      </section>

      <!-- OCR Experimental Feature -->
      <section id="viewOcr" class="view" style="display: none;">
        <div class="card">
          <div class="cardHeader">
            <h2>ğŸ“¸ Experimental: OCR Attendance Parser</h2>
            <p style="color: var(--text-secondary); margin-top: 8px; font-size: 14px;">
              Upload attendance sheet images and automatically extract student IDs using OCR. Review and fix uncertain results before generating the text file.
            </p>
          </div>

          <div class="ocrWorkflow">
            <!-- Step 1: Upload Images -->
            <div class="ocrStep" data-ocr-step="1">
              <h3 class="ocrStep__title">Step 1: Upload Attendance Images</h3>
              <div class="field">
                <label for="ocrImageUpload">Select attendance sheet images</label>
                <input 
                  id="ocrImageUpload" 
                  type="file" 
                  accept="image/*" 
                  multiple 
                />
                <div class="hint">
                  Upload one or more images of attendance sheets. Supports JPG, PNG, and other common image formats.
                </div>
              </div>
              <div id="ocrImagePreview" class="ocrImagePreview"></div>
              <button id="btnOcrProcess" class="btn btn--primary" type="button" disabled>
                Process Images with OCR
              </button>
            </div>

            <!-- Step 2: Processing -->
            <div class="ocrStep" data-ocr-step="2" style="display: none;">
              <h3 class="ocrStep__title">Step 2: Processing Images</h3>
              <div id="ocrProgress" class="ocrProgress">
                <div class="ocrProgress__bar">
                  <div id="ocrProgressFill" class="ocrProgress__fill"></div>
                </div>
                <div id="ocrProgressText" class="ocrProgress__text">Initializing OCR engine...</div>
              </div>
              <div id="ocrProcessingLog" class="ocrProcessingLog"></div>
            </div>

            <!-- Step 3: Review Results -->
            <div class="ocrStep" data-ocr-step="3" style="display: none;">
              <h3 class="ocrStep__title">Step 3: Review & Fix Extracted IDs</h3>
              <div class="ocrSummary">
                <div class="ocrSummary__item">
                  <strong>Total IDs Found:</strong> <span id="ocrTotalIds">0</span>
                </div>
                <div class="ocrSummary__item ocrSummary__item--success">
                  <strong>Confident Matches:</strong> <span id="ocrConfidentIds">0</span>
                </div>
                <div class="ocrSummary__item ocrSummary__item--warning">
                  <strong>Needs Review:</strong> <span id="ocrUncertainIds">0</span>
                </div>
              </div>

              <div class="ocrResults">
                <div class="ocrResults__section">
                  <h4>âœ… Confident Matches</h4>
                  <div id="ocrConfidentList" class="ocrIdList"></div>
                </div>
                <div class="ocrResults__section">
                  <h4>âš ï¸ Needs Review</h4>
                  <div id="ocrUncertainList" class="ocrIdList"></div>
                </div>
              </div>

              <div class="ocrActions">
                <button id="btnOcrApprove" class="btn btn--primary" type="button">
                  Approve & Generate Text File
                </button>
                <button id="btnOcrReset" class="btn btn--ghost" type="button">
                  Start Over
                </button>
              </div>
            </div>
          </div>

          <div id="ocrStatus" class="status" style="margin-top: 20px;" aria-live="polite"></div>
        </div>
      </section>

      <!-- Sheet Merger View -->
      <section id="viewSheetMerger" class="view" style="display: none;">
        <div class="card">
          <div class="cardHeader">
            <h2>ğŸ“Š Sheet Merger</h2>
            <p style="color: var(--text-secondary); margin-top: 8px; font-size: 14px;">
              Merge columns from multiple sheets into a single output. Upload your workbook, map columns using drag-and-drop, and download the merged result.
            </p>
          </div>

          <div class="sheetMergerWorkflow">
            <!-- Step 1: Upload File -->
            <div class="sheetMergerStep">
              <h3 class="sheetMergerStep__title">Step 1: Upload Workbook</h3>
              <div class="grid2">
                <div class="field">
                  <label for="mergerSheetUrl">Google Sheet URL (optional)</label>
                  <input
                    id="mergerSheetUrl"
                    type="url"
                    placeholder="https://docs.google.com/spreadsheets/d/.../edit"
                    autocomplete="off"
                  />
                  <div class="hint">
                    We'll try to download as <code>.xlsx</code>. If blocked by CORS, export manually: File â†’ Download â†’ Microsoft Excel (.xlsx), then upload below.
                  </div>
                </div>

                <div class="field">
                  <label for="mergerXlsxFile">Upload workbook (<code>.xlsx</code> or <code>.ods</code>)</label>
                  <input id="mergerXlsxFile" type="file" accept=".xlsx,.ods,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.oasis.opendocument.spreadsheet" />
                  <div class="hint">Upload your Excel or OpenDocument workbook. If ODS fails, convert to XLSX first.</div>
                </div>
              </div>
              <button id="btnMergerLoadFile" class="btn btn--primary" type="button" style="margin-top: 16px;">
                Load Workbook
              </button>
            </div>

            <!-- Step 2: Map Columns -->
            <div class="sheetMergerStep" id="mergerMappingStep" style="display: none;">
              <h3 class="sheetMergerStep__title">Step 2: Map Columns</h3>
              <p style="color: var(--text-secondary); margin-bottom: 16px;">
                Drag columns from the pool on the left to the matrix on the right. Each slot can hold one column. Columns will be concatenated sequentially (Sheet1 rows, then Sheet2 rows, etc.).
              </p>

              <div class="sheetMergerLayout">
                <!-- Column Pool -->
                <div class="columnPool">
                  <div class="columnPool__header">
                    <h4>Available Columns</h4>
                    <div class="hint">Search or expand sheets below, then drag to matrix â†’</div>
                  </div>
                  <div class="columnPool__toolbar">
                    <input 
                      id="mergerColumnSearch" 
                      type="text" 
                      class="columnPool__search" 
                      placeholder="ğŸ” Search columns..."
                      autocomplete="off"
                    />
                  </div>
                  <div id="mergerColumnPool" class="columnPool__list">
                    <!-- Dynamically populated with accordion groups -->
                  </div>
                </div>

                <!-- Mapping Matrix -->
                <div class="mappingMatrix">
                  <div class="mappingMatrix__header">
                    <div>
                      <h4>Output Columns (Drag columns here)</h4>
                      <div class="hint">Each row = one sheet, each column = output position</div>
                    </div>
                    <div id="mergerColumnControls" style="display: flex; gap: 8px; align-items: center;">
                      <!-- Column control buttons will be added here by renderMappingMatrix -->
                    </div>
                  </div>
                  <div id="mergerMappingMatrix" class="mappingMatrix__grid">
                    <!-- Dynamically populated with drop zones -->
                  </div>
                </div>
              </div>

              <div class="field" style="margin-top: 20px;">
                <label class="labelInline">
                  <input id="mergerEliminateHeaders" type="checkbox" style="margin-right: 6px;" />
                  Eliminate duplicate header rows (recommended when concatenating sheets)
                </label>
              </div>

              <button id="btnMergerAutoFill" class="btn btn--secondary" type="button" style="margin-top: 16px;">
                Auto-Fill Remaining Sheets
              </button>
              <div class="hint" style="margin-top: 4px; margin-bottom: 0;">
                After mapping the first sheet row, click to automatically fill remaining sheets with matching columns (case-insensitive name match, within Â±1 column position)
              </div>

              <button id="btnMergerGeneratePreview" class="btn btn--primary" type="button" style="margin-top: 16px;">
                Generate Preview
              </button>
            </div>

            <!-- Step 3: Preview & Download -->
            <div class="sheetMergerStep" id="mergerPreviewStep" style="display: none;">
              <h3 class="sheetMergerStep__title">Step 3: Review & Download</h3>
              <div class="mergerPreviewSummary">
                <div class="mergerPreviewSummary__item">
                  <strong>Total Rows:</strong> <span id="mergerPreviewRowCount">0</span>
                </div>
                <div class="mergerPreviewSummary__item">
                  <strong>Total Columns:</strong> <span id="mergerPreviewColCount">0</span>
                </div>
                <div class="mergerPreviewSummary__item">
                  <strong>Source Sheets:</strong> <span id="mergerPreviewSheetCount">0</span>
                </div>
              </div>

              <div class="tableWrap" style="max-height: 500px; overflow: auto; margin-top: 16px;">
                <table class="table" aria-label="Merged data preview">
                  <thead id="mergerPreviewTableHead">
                    <!-- Dynamically populated -->
                  </thead>
                  <tbody id="mergerPreviewTableBody">
                    <!-- Dynamically populated -->
                  </tbody>
                </table>
              </div>

              <div class="mergerActions" style="margin-top: 20px; display: flex; gap: 12px;">
                <button id="btnMergerDownload" class="btn btn--primary" type="button">
                  Download Merged File (.xlsx)
                </button>
                <button id="btnMergerLoadMore" class="btn btn--secondary" type="button" style="display: none;">
                  Load More Rows
                </button>
                <button id="btnMergerBack" class="btn btn--ghost" type="button">
                  Back
                </button>
              </div>
            </div>
          </div>

          <div id="mergerStatus" class="status" style="margin-top: 20px;" aria-live="polite"></div>
        </div>
      </section>

      <!-- Report View -->
      <section id="viewReport" class="view">
        <div class="card card--report">
          <div class="cardHeader">
            <h2>Edit Preview & Report</h2>
            <div class="cardHeader__actions">
              <div class="field field--inline" style="margin-right: 12px;">
                <label for="highlightCheckbox" class="labelInline">
                  <input id="highlightCheckbox" type="checkbox" checked style="margin-right: 6px;" />
                  Highlight modified cells
                </label>
                <input id="highlightColorPicker" type="color" value="#FFFF00" title="Select highlight color" style="margin-left: 8px; height: 32px; width: 50px; cursor: pointer;" />
              </div>
              <button id="btnEditorDownload" class="btn" type="button" disabled>Download Modified File</button>
              <button id="btnDownloadModifiedRecords" class="btn" type="button" disabled>Download Modified Records</button>
              <button id="btnDownloadOriginalRecords" class="btn" type="button" disabled>Download Original Records</button>
              <button id="btnDownloadJson" class="btn" type="button" disabled>Download JSON</button>
              <button id="btnDownloadTxt" class="btn" type="button" disabled>Download TXT</button>
              <button id="btnDownloadPdf" class="btn" type="button" disabled>Download PDF</button>
            </div>
          </div>

          <div class="toolbar">
            <div class="segmented" role="tablist" aria-label="Preview mode">
              <button id="editorPreviewModeGrouped" class="segmented__btn is-active" type="button" role="tab" aria-selected="true">
                Grouped by sheet
              </button>
              <button id="editorPreviewModeOrdered" class="segmented__btn" type="button" role="tab" aria-selected="false">
                Input order
              </button>
            </div>

            <div class="field field--inline">
              <label for="loadReportJson" class="labelInline">Load previous report JSON</label>
              <input id="loadReportJson" type="file" accept=".json,application/json" />
            </div>

            <div class="field field--inline viewerHeader__filter">
              <label for="editorPreviewSheetFilter" class="labelInline">Sheet</label>
              <select id="editorPreviewSheetFilter" disabled>
                <option value="">All Sheets</option>
              </select>
            </div>
          </div>

          <div class="summaryRow">
            <div id="summary" class="summary">No preview generated. Go to Inputs tab to configure and generate preview.</div>
          </div>

          <div class="viewer">
            <section class="viewer__main">
              <div class="tableWrap">
                <table class="table" aria-label="Editor preview table">
                  <thead>
                    <tr>
                      <th>#</th>
                      <th>ID</th>
                      <th>Name</th>
                      <th>Sheet</th>
                      <th>Cell</th>
                      <th>Old</th>
                      <th>New</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="editorPreviewTableBody"></tbody>
                </table>
              </div>

              <div id="delimiterFilterContainer" class="delimiterFilter" style="display: none;">
                <div class="field field--inline">
                  <label for="editorDelimiterFilter" class="labelInline">Filter by delimiter</label>
                  <select id="editorDelimiterFilter">
                    <option value="">Show All</option>
                  </select>
                </div>
              </div>

              <div class="missing">
                <div class="viewerTitle">Final column mapping report</div>
                <textarea id="editorFinalReportBox" readonly rows="4">(Generate preview first)</textarea>
              </div>
            </section>
          </div>
        </div>
      </section>

      <!-- About View -->
      <section id="viewAbout" class="view">
        <div class="card">
          <div class="aboutHeader">
            <h2>About Yaqeen</h2>
          </div>
          
          <div class="aboutContent">
            <div class="aboutSection">
              <p class="aboutText">
                Hi, I'm <b>Mohammed Abusarie</b>, a Teaching Assistant at the Egyptian Chinese University. I built this tool to help my fellow TAs automate the tedious and time-consuming tasks of marking attendance and inputting grades. I believe automation is the key to solving real problems and freeing up time for what truly mattersâ€”teaching, learning, and connecting with students.
              </p>
              <p class="aboutText__arabic">
                Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø£Ù†Ø§ <b>Ù…Ø­Ù…Ø¯ Ø£Ø¨ÙˆØ³Ø±ÙŠØ¹</b>ØŒ Ù…Ø³Ø§Ø¹Ø¯ ØªØ¯Ø±ÙŠØ³ ÙÙŠ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ù…ØµØ±ÙŠØ© Ø§Ù„ØµÙŠÙ†ÙŠØ©. ØµÙ…Ù…Øª Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø²Ù…Ù„Ø§Ø¦ÙŠ Ù…Ø³Ø§Ø¹Ø¯ÙŠ Ø§Ù„ØªØ¯Ø±ÙŠØ³ ÙÙŠ Ø£ØªÙ…ØªØ© Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø±Ù‡Ù‚Ø© ÙˆØ§Ù„Ù…Ø³ØªÙ‡Ù„ÙƒØ© Ù„Ù„ÙˆÙ‚Øª ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª. Ø£Ø¤Ù…Ù† Ø¨Ø£Ù† Ø§Ù„Ø£ØªÙ…ØªØ© Ù‡ÙŠ Ø§Ù„Ù…ÙØªØ§Ø­ Ù„Ø­Ù„ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© ÙˆØªØ­Ø±ÙŠØ± Ø§Ù„ÙˆÙ‚Øª Ù„Ù…Ø§ ÙŠÙ‡Ù… Ø­Ù‚Ø§Ù‹â€”Ø§Ù„ØªØ¯Ø±ÙŠØ³ ÙˆØ§Ù„ØªØ¹Ù„Ù… ÙˆØ§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø·Ù„Ø§Ø¨.
              </p>
            </div>
          </div>
        </div>

        <div class="card" style="margin-top: 24px;">
          <div class="aboutHeader">
            <h2>What is Yaqeen?</h2>
          </div>
          
          <div class="aboutContent">
            <div class="aboutSection">
              <p class="aboutText">
                <b>"Yaqeen"</b> (ÙŠÙÙ‚ÙÙŠÙ†) in Arabic means <b>certainty, conviction, or assurance</b>. The name reflects the core values of this tool:
              </p>
              <ul class="aboutText" style="margin-top: 12px; padding-left: 24px; line-height: 1.8;">
                <li><b>Certainty in automation:</b> Accurate, reliable attendance marking that you can trust completely.</li>
                <li><b>Conviction about automation:</b> My belief that automation solves real problems and transforms how we work.</li>
                <li><b>Assurance and confidence:</b> You can rely on the tool to handle complex matching and data processing with precision.</li>
              </ul>
              <p class="aboutText" style="margin-top: 16px;">
                The name embodies both the reliability goalâ€”ensuring every attendance mark is accurateâ€”and the conviction that automation frees time for what truly matters. This project is built with thoughtful design and careful implementation to deliver that certainty.
              </p>
              <p class="aboutText__arabic" style="margin-top: 16px;">
                <b>"ÙŠÙÙ‚ÙÙŠÙ†"</b> Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ØªØ¹Ù†ÙŠ <b>Ø§Ù„ÙŠÙ‚ÙŠÙ† Ø£Ùˆ Ø§Ù„Ø«Ù‚Ø© Ø£Ùˆ Ø§Ù„ØªØ£ÙƒÙŠØ¯</b>. ÙŠØ¹ÙƒØ³ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø©:
              </p>
              <ul class="aboutText__arabic" style="margin-top: 12px; padding-left: 24px; line-height: 1.8;">
                <li><b>Ø§Ù„ÙŠÙ‚ÙŠÙ† ÙÙŠ Ø§Ù„Ø£ØªÙ…ØªØ©:</b> ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± Ø¯Ù‚ÙŠÙ‚ ÙˆÙ…ÙˆØ«ÙˆÙ‚ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ÙˆØ«ÙˆÙ‚ Ø¨Ù‡ ØªÙ…Ø§Ù…Ø§Ù‹.</li>
                <li><b>Ø§Ù„Ø¥ÙŠÙ…Ø§Ù† Ø¨Ø§Ù„Ø£ØªÙ…ØªØ©:</b> Ø§Ø¹ØªÙ‚Ø§Ø¯ÙŠ Ø¨Ø£Ù† Ø§Ù„Ø£ØªÙ…ØªØ© ØªØ­Ù„ Ù…Ø´Ø§ÙƒÙ„ Ø­Ù‚ÙŠÙ‚ÙŠØ© ÙˆØªØºÙŠØ± Ø·Ø±ÙŠÙ‚Ø© Ø¹Ù…Ù„Ù†Ø§.</li>
                <li><b>Ø§Ù„Ø·Ù…Ø£Ù†ÙŠÙ†Ø© ÙˆØ§Ù„Ø«Ù‚Ø©:</b> ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¯Ø§Ø© Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø© ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¯Ù‚Ø©.</li>
              </ul>
              <p class="aboutText__arabic" style="margin-top: 16px;">
                ÙŠØ¬Ø³Ø¯ Ø§Ù„Ø§Ø³Ù… ÙƒÙ„ Ù…Ù† Ù‡Ø¯Ù Ø§Ù„Ù…ÙˆØ«ÙˆÙ‚ÙŠØ©â€”Ø¶Ù…Ø§Ù† Ø¯Ù‚Ø© ÙƒÙ„ Ø¹Ù„Ø§Ù…Ø© Ø­Ø¶ÙˆØ±â€”ÙˆØ§Ù„Ø§Ù‚ØªÙ†Ø§Ø¹ Ø¨Ø£Ù† Ø§Ù„Ø£ØªÙ…ØªØ© ØªØ­Ø±Ø± Ø§Ù„ÙˆÙ‚Øª Ù„Ù…Ø§ ÙŠÙ‡Ù… Ø­Ù‚Ø§Ù‹. ØªÙ… Ø¨Ù†Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¨ØªØµÙ…ÙŠÙ… Ù…Ø¯Ø±ÙˆØ³ ÙˆØªÙ†ÙÙŠØ° Ø¯Ù‚ÙŠÙ‚ Ù„ØªÙ‚Ø¯ÙŠÙ… Ø°Ù„Ùƒ Ø§Ù„ÙŠÙ‚ÙŠÙ†.
              </p>
            </div>
          </div>
        </div>

        <div class="card" style="margin-top: 24px;">
          <div class="aboutHeader">
            <h2>Beta Launch</h2>
          </div>
          
          <div class="aboutContent">
            <div class="aboutSection">
              <p class="aboutText">
                This is the <b>beta version</b> of Yaqeen, launched on <b>December 18, 2025</b>. As this marks the tool's first release, your feedback is invaluable. I'm committed to continuously improving Yaqeen based on your experiences and needs.
              </p>
              <p class="aboutText" style="margin-top: 12px;">
                Please report any bugs you encounter or share features you'd like to see in future versions. Together, we can make Yaqeen stronger, more efficient, and more reliable for everyone.
              </p>
              <p class="aboutText" style="margin-top: 16px;">
                <b>Contact:</b> <a href="mailto:mohammed.abusarie@ecu.edu.eg">mohammed.abusarie@ecu.edu.eg</a>
              </p>
              <p class="aboutText__arabic" style="margin-top: 16px;">
                Ù‡Ø°Ù‡ <b>Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©</b> Ù…Ù† ÙŠÙÙ‚ÙÙŠÙ†ØŒ ØªÙ… Ø¥Ø·Ù„Ø§Ù‚Ù‡Ø§ ÙÙŠ <b>18 Ø¯ÙŠØ³Ù…Ø¨Ø± 2025</b>. Ø¨Ù…Ø§ Ø£Ù† Ù‡Ø°Ø§ ÙŠÙ…Ø«Ù„ Ø§Ù„Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ø£ÙˆÙ„ Ù„Ù„Ø£Ø¯Ø§Ø©ØŒ ÙØ¥Ù† Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ Ù„Ø§ ØªÙ‚Ø¯Ø± Ø¨Ø«Ù…Ù†. Ø£Ù†Ø§ Ù…Ù„ØªØ²Ù… Ø¨ØªØ­Ø³ÙŠÙ† ÙŠÙÙ‚ÙÙŠÙ† Ø¨Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ØªØ¬Ø§Ø±Ø¨Ùƒ ÙˆØ§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ.
              </p>
              <p class="aboutText__arabic" style="margin-top: 12px;">
                ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø£ÙŠ Ø£Ø®Ø·Ø§Ø¡ ØªÙˆØ§Ø¬Ù‡Ù‡Ø§ Ø£Ùˆ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„ØªÙŠ ØªØ±ØºØ¨ ÙÙŠ Ø±Ø¤ÙŠØªÙ‡Ø§ ÙÙŠ Ø§Ù„Ø¥ØµØ¯Ø§Ø±Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©. Ù…Ø¹Ø§Ù‹ØŒ ÙŠÙ…ÙƒÙ†Ù†Ø§ Ø¬Ø¹Ù„ ÙŠÙÙ‚ÙÙŠÙ† Ø£Ù‚ÙˆÙ‰ ÙˆØ£ÙƒØ«Ø± ÙƒÙØ§Ø¡Ø© ÙˆÙ…ÙˆØ«ÙˆÙ‚ÙŠØ© Ù„Ù„Ø¬Ù…ÙŠØ¹.
              </p>
              <p class="aboutText__arabic" style="margin-top: 16px;">
                <b>Ù„Ù„ØªÙˆØ§ØµÙ„:</b> <a href="mailto:mohammed.abusarie@ecu.edu.eg">mohammed.abusarie@ecu.edu.eg</a>
              </p>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Dialogs (accessible from all views) -->
    <dialog id="editorFixDialog" class="modal">
      <form method="dialog" class="modal__content">
        <div class="modal__header">
          <div class="modal__title">Fix student match</div>
          <button class="btn btn--ghost" value="cancel" type="submit">Close</button>
        </div>

        <div class="field" style="margin-top: 12px;">
          <label for="editorFixSearch">Search by ID or name</label>
          <input id="editorFixSearch" type="text" autocomplete="off" placeholder="Type to searchâ€¦" />
          <div class="hint">Results update as you type. Click a result to apply the fix.</div>
        </div>

        <div id="editorFixResults" class="searchResults" aria-label="Search results"></div>
      </form>
    </dialog>

    <dialog id="editorGradeDialog" class="modal">
      <form method="dialog" class="modal__content">
        <div class="modal__header">
          <div class="modal__title">Edit grade</div>
          <button class="btn btn--ghost" value="cancel" type="submit">Close</button>
        </div>

        <div class="field" style="margin-top: 12px;">
          <label for="editorGradeValue">New grade</label>
          <input id="editorGradeValue" type="text" autocomplete="off" placeholder="e.g. 15" />
          <div class="hint">This only changes the preview. The workbook is modified only after download confirmation.</div>
        </div>

        <div class="actions" style="margin-top: 14px;">
          <button id="editorGradeSave" class="btn btn--primary" value="ok" type="submit">Save</button>
          <button class="btn btn--ghost" value="cancel" type="submit">Cancel</button>
        </div>
      </form>
    </dialog>

    <footer class="footer">
      <p>
        <b>Tip:</b> If URL download fails, download the file manually: <b>Google Sheets</b> â†’ <b>File â†’ Download â†’ Microsoft Excel (.xlsx)</b>, or <b>SharePoint</b> â†’ <b>Download</b> (choose .xlsx, .ods, or .csv), then upload it above.
      </p>
      <p style="margin-top: 8px; opacity: 0.8;">
        Â© <span id="footerYear"></span> Mohammed Abusarie
      </p>
    </footer>

    <!-- SheetJS with styling support (XLSX parser) -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx.bundle.js"></script>
    <!-- jsPDF + AutoTable for PDF export -->
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.4/dist/jspdf.plugin.autotable.min.js"></script>
    <!-- Tesseract.js for OCR -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <!-- OpenCV.js for table detection -->
    <script async src="https://docs.opencv.org/4.10.0/opencv.js" onload="onOpenCvReady();" type="text/javascript"></script>
    <script type="module" src="./app.js"></script>
  </body>
</html>


